<!DOCTYPE html>

<html>
<head>
<title>
   Stimmungskompass
  </title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="{{ url_for('favicon') }}" type="image/x-icon">
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>


</script>
<!-- Leaflet Draw CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" rel="stylesheet"/>
<!-- Leaflet Draw JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js">
</script>
<!-- Heatmap plugin -->
<!-- JQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">
</script>

<!-- Include Spectrum's CSS from CDN -->
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.1/spectrum.min.css" />

<!-- Include Spectrum's JavaScript from CDN -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.1/spectrum.min.js"></script>


<div id="landscape-blocker" style="display: none;">
    <p>Der Stimmungskompass ist nur im Hochformat verfügbar.</p>
    <img id="anti-rotate-image" src="static/antirotate.png" alt="Rotate Device" style="max-width: 30%; height: auto; display: block; margin: 0 auto;">
</div>

<div id="portrait-blocker" style="display: none;">
    <p>Der Stimmungskompass ist nur im Querformat verfügbar.</p>
    <img id="anti-rotate-image" src="static/antirotate_ipad.png" alt="Rotate Device" style="max-width: 30%; height: auto; display: block; margin: 0 auto;">
</div>


<style type="text/css">
  background-color: var(--background-color); /* Apply background color */
    color: var(--text-color); /* Apply text color */  </style>
</head>

<style>
  /* BASIC CSS START */
body, html {
    margin: 0;
    padding: 0;
    overflow: hidden; /* Prevent scrolling */
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
    font-family: 'Roboto', sans-serif !important;
    background-color: var(--background-color); /* Apply background color */
    color: var(--text-color); /* Apply text color */
}

.resistant-h3 {
    color: var(--text-color); /* Use the text color based on the current theme */
    /* Add other styles as needed */
}

.filterx-container {
display:none !important;
}

/* Add this to your CSS file or within a <style> tag in your HTML */
.button-hover-effect {
    display: inline-block;
    background-color: #3a3a3a;
    padding: 5px 7px;
    text-decoration: none;
    border-radius: 30px;
    margin-top: 10px;
    margin-bottom: 10px;
    transition: transform 0.3s ease, background-color 0.3s ease;
}

.button-hover-effect:hover {
    transform: scale(1.02);
    background-color: #111111; /* Light blue color */
}

.voting-bar {
    width: 100%;
    height: 20px;
    background-color: #ddd;
    border-radius: 30px !important;
    margin-top: 30px;
    display: flex;
}

.upvotes {
    height: 100%;
    background-color: #4caf50;
    border-radius: 30px !important;
    transition: width 0.3s ease;
}

.downvotes {
    height: 100%;
    background-color: #b71c1c;
    border-radius: 30px !important;
    transition: width 0.3s ease;
}


#landscape-blocker {
    display: none; /* Initially hidden */
    position: fixed; /* Overlay the whole screen */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: black; /* Black background */
    color: white; /* White text color */
    z-index: 9999; /* Ensure it's on top of other elements */
    display: flex;
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    text-align: center; /* Ensure text alignment is centered */
}

.object-item-text {
    color: var(--text-color); /* Use CSS variable for dynamic color */
}

/* Optional: Add media query for smaller screens if the text is too large */
@media (max-width: 768px) {
    #landscape-blocker {
        font-size: 16px;
    }
}

#portrait-blocker {
    display: none; /* Initially hidden */
    position: fixed; /* Overlay the whole screen */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: black; /* Black background */
    color: white; /* White text color */
    z-index: 9999; /* Ensure it's on top of other elements */
    display: flex;
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    text-align: center; /* Ensure text alignment is centered */
}

/* Optional: Add media query for larger screens */
@media (min-width: 768px) {
    #portrait-blocker {
        font-size: 20px;
    }
}

*, *:before, *:after {
    box-sizing: inherit; /* Inherit box-sizing */
}

/* Desktop Styles */
@media (min-width: 768px) {
    #map, #sidebar {
        position: absolute;
        top: 95px; /* Increased from 15px to 95px to accommodate the top bar's height */
        bottom: 15px;
        border-radius: 30px;
		    overflow-y: auto; /* Enables vertical scrolling */

    }

    #map {
        left: 15px;
        right: calc(30% + 15px);
    }

    #sidebar {
        position: absolute;
        width: calc(30% - 15px);
        right: 15px;
        top: 95px; /* Increased from 15px to 95px to accommodate the top bar's height */
        bottom: 15px;
        padding: 10px;
        border-radius: 30px;
        background: var(--sidebar-bg); /* Use variable for background */
    }
}


@media (max-width: 768px) {
    .desktop-only {
        display: none;
    }
}



#map {
    left: 15px; /* Consistent margin from the left */
    right: calc(30% + 15px); /* Adjusting for sidebar width and margin */
}

#sidebar {
    width: calc(30% - 15px); /* Sidebar takes up 30% width minus right margin */
    right: 15px; /* Consistent margin from the right */
    padding: 10px;
}


/* Custom Scrollbar Styles */
/* For Webkit (Chrome, Safari, Edge) */
::-webkit-scrollbar {
    width: 0px; /* Hide scrollbar globally */
}

.faded {
    opacity: 0.5; /* Adjust the value as needed for the desired faded effect */
    transition: opacity 0.3s ease; /* Smooth transition for the opacity change */
}


::-webkit-scrollbar-thumb {
    background-color: transparent; /* Invisible scrollbar thumb globally */
}

	.user-info {
    color: white; /* Set the text color to match other links */
    margin-right: 20px; /* Right margin for spacing */
    font-size: 18px; /* Font size similar to other links */
    font-weight: bold; /* Bold text */
    align-self: center; /* Align vertically within the flex container */
}

/* Hide scrollbar for IE, Edge, and Firefox */
body {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
}

/* Custom scrollbar for object list */
#object-list::-webkit-scrollbar {
    width: 6px; /* Adjust the width for object list */
}

#object-list::-webkit-scrollbar-thumb {
    background-color: #888; /* Customize the scrollbar thumb color for object list */
    border-radius: 3px; /* Add rounded corners for object list scrollbar */
}

#object-list {
    overflow-y: auto; /* Enable scrolling for object list */
    max-height: 350px; /* Adjust height as needed */
    scrollbar-width: thin; /* Use a thin scrollbar for the object list in Firefox */
    -ms-overflow-style: scrollbar; /* Enable scrollbar for IE and Edge */
}

/* Exception for the scrollbar inside the object list */
#object-list.custom-scrollbar {
    border-radius: 10px; /* Add rounded corners to the object list */
}

/* Custom Scrollbar CSS End */



/* CITY PICTURE CSS START */
.logo-img {
max-width: 100%;
width: 100%;
box-sizing: border-box;
height: auto;
display: block;
margin-left:auto;
margin-right:auto;
margin-top: 3px;
margin-bottom: 8px; 
border-radius: 30px;"
}
/* CITY PICTURE CSS END */

/* LEAFLET MAP PILL CSS */
.leaflet-bar, .leaflet-draw-section, .leaflet-draw-section {
  border-radius: 30px !important;
  border: none;
  background-color: var(--leaflet-control-bg-dark) !important; /* Use variable */
}

/* LEAFLET MAP ICONS CSS */
.leaflet-control-zoom-in, .leaflet-control-zoom-out, .leaflet-draw-draw-polyline, .leaflet-draw-draw-polygon, .leaflet-draw-draw-rectangle, .leaflet-draw-draw-circle, .leaflet-draw-draw-marker, .leaflet-draw-draw-circlemarker, .leaflet-draw-edit-edit, .leaflet-draw-edit-remove {
  background-color: #f5f1e4 !important; /* Use variable */
  color: #000000 !important; /* Use variable */
  border: none !important;
  font-size: 18px !important;
  line-height: 30px !important;
  width: 30px !important;
  height: 30px !important;
}

.leaflet-draw-draw-rectangle {
  background-image: url('rectangle_darkmode_svg.svg'); /* Replace with the path to your new icon */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}
/* LEAFLET MAP ICONS CSS END */



.leaflet-draw-draw-marker {
display: none !important;
}

.leaflet-draw-draw-polyline {
display: none !important;
}

.leaflet-draw-draw-circlemarker {
display: none !important;
}

/* LEAFLET MAP ICON COLOR CHANGE WHEN DISABLED CSS START */
.leaflet-disabled {
  background-color:#3a3a3a !important;
  color: #ffffff !important;
}

/* LEAFLET MAP ICON COLOR CHANGE WHEN DISABLED CSS END */



/* LEAFLET MAP ICON BORDER REMOVAL CSS START */
.leaflet-control-zoom-in, .leaflet-control-zoom-out {
  border-top: none !important;
  border-bottom: none !important;
  border-radius: 0 !important;
}
/* LEAFLET MAP ICON BORDER REMOVAL CSS END */



/* LEAFLET MAP ICON MISC CSS START */
.leaflet-bar > a:first-child {
  border-top-left-radius: 30px !important;
  border-top-right-radius: 30px !important;
}

.leaflet-bar > a:last-child {
  border-bottom-left-radius: 30px !important;
  border-bottom-right-radius: 30px !important;
}


.leaflet-control-layers-toggle {
    font-size: 30px;
    line-height: 24px;
    font-weight: bold;
    text-align: center;
    border-radius: 30px;
    background-repeat: no-repeat;
    background-position: center;
    width: 36px;
    height: 36px;
}

.leaflet-control-layers {
    border-radius: 30px;
    opacity: 1;
}

.leaflet-control-layers::before {
    content: "";
    background-image: var(--leaflet-control-layers-before-bg);
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 30px;
    background-size: cover;
    opacity: 1;
}




/* Hide the background image when the control layers menu is expanded */
.leaflet-control-layers-expanded::before {
    content: none !important;
}

.leaflet-control-layers-expanded .leaflet-control-layers-list {
    color: #ffffff !important;

    font-size: 15px;
    font-weight: bold;
    padding: 10px;  /* Added padding here */
}

.leaflet-control-layers-selector {
    color: #ffffff !important;
	
    margin: 2px !important;
}

.leaflet-popup .leaflet-popup-content-wrapper .leaflet-popup-content {
    font-size: 25px !important;
}


/* Your existing rules for .leaflet-control-layers and .leaflet-top leaflet-right had typos, corrected below */
.leaflet-control-layers.leaflet-control {
		background-color: #f5f1e4 !important;

    border-radius: 30px;
}

.leaflet-top.leaflet-right {
    border-radius: 50px;
}

    .leaflet-popup .shape-image {
        max-width: 512px;
        max-height: 512px;
        display: block;
        margin: 0 auto;
    }
	
	

    .leaflet-popup-content-wrapper {
    background-color: #f5f1e4 !important;
    color: #000000 !important;
    border-radius: 30px !important;
	width: auto !important;
}

   .leaflet-popup-content {
    color: #000000 !important;
}

.leaflet-popup-tip {
    display: block; /* Optional: hides the tip arrow for a cleaner look */
    background-color: var(--popup-bg-color) !important;
}
	
	  .leaflet-popup-close-button {
        display: none; /* Optional: hides the tip arrow for a cleaner look */

    }
.leaflet-popup.image-popup .leaflet-popup-tip {
    display: none;
}	
  

   #shape-note {
        border-radius: 10px;
		border:none;
        display: block;
		color: #111111;
        width: 100%;
        box-sizing: border-box;
        max-height: 200px;
		height: 75px;
		padding: 5px;
		max-width: 100%;
        margin-bottom: -25px; /* Adjust this value as needed to reduce gap */
		font-size: 15px; /* Set font size to 15px */
        font-family: 'Roboto', sans-serif; /* Set font family to Roboto */
    }


#shape-note::-webkit-input-placeholder { /* Chrome, Opera, Safari */
    color: #111111;
    opacity: 1; /* Override any default opacity */
}

#shape-note:-ms-input-placeholder { /* Internet Explorer 10-11 */
    color: #111111;
    opacity: 1; /* Override any default opacity */
}

#shape-note::-ms-input-placeholder { /* Microsoft Edge */
    color: #111111;
    opacity: 1; /* Override any default opacity */
}

#shape-note::placeholder { /* Most modern browsers */
    color: #111111;
    opacity: 1; /* Override any default opacity */
}

    #save-note, #cancel-note {
        background-color: #4CAF50; /* Green for save, red for cancel */
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 30px;
        cursor: pointer;
        font-weight: bold;
        transition: background-color 0.2s ease-in-out;
        margin-top: 0; /* Remove top margin to reduce gap */
    }

    #cancel-note {
        background-color: #B71C1C;
        margin-left: 50px; /* Adjust this value as needed */
    }

    #save-note:hover {
        background-color: #388E3C; /* Darker green for hover effect */
    }

    #cancel-note:hover {
        background-color: #D32F2F; /* Darker red for hover effect */
    }

/* LEAFLET MAP ICON MISC CSS END */



/* SMALL OPTIONS MENU TOP BUTTON CSS START */
/* This CSS makes sure the "smalloptionsmenutop" entity is resized properly */
 .smalloptionsmenutop {
      display: flex;
      justify-content: space-between;
    }
    .left-container, .right-container {
      display: flex;
      align-items: center;
    }
    .pinlist-div, .info-div, .lightswitch-div, .key-div {
      margin: 0 3px;
    }
}

  
    /* Individual icon divs */
    .lightswitch-div, .key-div, .pinlist-div, .info-div {
      flex-direction: row;
    }

    /* Make the containers hidden when screen width is less than 1271px */
    @media (max-width: 1271px) and (min-width: 768px) {
	  .left-container, .right-container, .togglebuttoncontainer {
		display: in-line;
	  }
	}
	
	@media (min-width: 768px) and (max-width: 1271px) {
    #keyDiv img, 
    #infoDiv img, 
    #pinlistdiv img, 
    #lightswitchDiv img {
        max-width: 30px !important; /* Set the max-width to 30px for tablet screens */
        height: auto; /* Maintain the aspect ratio of the images */
        border-radius: 30px; /* Maintain the border radius */
    }
}

@media (min-width: 768px) and (max-width: 1271px) {
    .button-s {
        max-height: 30px !important; /* Set the max height to 30px for tablet screens */
        padding: 10px; /* Adjust padding as needed */
    }
  .button-s h3 {
        font-size: 16px; /* Adjust the font size as needed for tablet screens */
        margin: 0; /* You might want to reset any default margin */
    }
}

		/* Icon scaler */
        #keyDiv {
            cursor: pointer;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center; /* Vertically center the image */
        }

        #keyDiv img {
            max-width: 40px;  /* Adjust size as needed */
            height: auto;
            border-radius: 30px;
            margin: 0;
        }
		
        #infoDiv {
            cursor: pointer;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center; /* Vertically center the image */
        }

        #infoDiv img {
            max-width: 40px;  /* Adjust size as needed */
            height: auto;
            border-radius: 30px;
            margin: 0;
        }
		
        #pinlistdiv {
            cursor: pointer;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center; /* Vertically center the image */
        }

        #pinlistdiv img {
            max-width: 40px;  /* Adjust size as needed */
            height: auto;
            border-radius: 30px;
            margin: 0;
        }
		
        #lightswitchDiv {
            cursor: pointer;
            margin: 0;
            padding: 0;
            display: flex;
            align-items: center; /* Vertically center the image */
        }

        #lightswitchDiv img {
            max-width: 40px;  /* Adjust size as needed */
            height: auto;
            border-radius: 30px;
            margin: 0;
        }
/* SMALL OPTIONS MENU BUTTON CSS END */


/* BUTTON MAIN UNIVERSAL CSS START */
.button-u {
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 14px 0;
    padding: 15px;
    box-sizing: border-box;
    cursor: pointer;
    text-decoration: none;
	    white-space: normal;
    border-radius: 30px;
    transition: background-color 0.2s ease-in-out;
    color: white;
    text-align: center;
    line-height: 1;
    max-height: 40px;
    width: 100%;
}
/* BUTTON MAIN UNIVERSAL CSS END */



/* BUTTON SMALL SIDEBAR CSS START */
/* This button is used mainly for Wie funktionierts. */
.button-s {
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 14px 0;
    padding: 15px;
    box-sizing: border-box;
    cursor: pointer;
    text-decoration: none;
	    white-space: normal;
    border-radius: 30px;
    background-color: #111111; /* Use a general variable */
    transition: background-color 0.2s ease-in-out;
    color: white;
    text-align: center;
    line-height: 1;
    max-height: 40px;
    width: 100%;
}
/* BUTTON SMALL SIDEBAR CSS END */
  /* HOVER AND SELECTED BUTTON EFFECT CSS START */
        /* Hover effect */
        .button-s:hover,
        .categorybutton:hover,
        .save-note:hover,
        .key-div:hover,
        .pinlist-div:hover,
        .info-div:hover,
        .lightswitch-div:hover {
             filter: brightness(115%) !important;
    outline: 3px solid var(--outline-hover-color) !important; /* Use custom property */
}


/* INFO-POPUP CONTAINER CSS START */
/* Takes care of how big the info-popup is gonna be. This popup shows information about each element on the website. */
    #info-popup {
        padding: 20px;
        max-width: 500px;
        font-size: 14px;
        z-index: 1000;  /* Make sure the popup appears above the map */
     background-color: var(--popup-bg-color);
    color: var(--popup-text-color);
}
#info-popup.admin-pindelete-popup {
    max-width: 300px;
}
	
	#info-popup.uigif-counter-popup {
    max-width: 320px;
}

#info-popup.uigif-counter-popup img {
    border-radius: 30px;
}

#info-popup.admin-pinresize-popup {
 max-width: 300px;
}
/* INFO-POPUP CONTAINER CSS END */

.count-pill {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
    padding: 10px;
    border-radius: 30px;
    background-color: white;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 10;
}

.color-circle {
    height: 15px;
    width: 15px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 10px; /* Adjust as needed */
}

.category-symbol {
    height: 25px;
    width: 25px;
    margin-right: 10px; /* Adjust as needed */
}

#counter-pill {
    position: absolute;
    top: 4.5%;
    left: 50%;
    outline: 2px solid rgba(0,0,0,0.2);
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 30px;
    padding: 8px 12px; /* Increased left and right padding */
    z-index: 1000;
    font-size: 25px;
    font-weight: bold;
    gap: 5px;
   background-color: var(--counter-pill-bg-color);
    color: var(--counter-pill-text-color);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 80%; /* Increased maximum width */
}

.counter-color, .marker-btn {
    height: 25px; /* Adjusted to match desktop version */
    width: 25px; /* Adjusted to match desktop version */
    border-radius: 50%;
    display: inline-block;
    margin-right: 2.5px; /* Consistent space after the circle */
	    margin-left: 2.5px; /* Consistent space after the circle */

}

#color-counters, #category-counters {
    display: flex;
    padding: 0;
    margin: 0;
    gap: 5px;
}
.iframe-container {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* Aspect ratio: 16/9 */
    height: 0;
}

.iframe-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

#color-counters li, #category-counters li {
    flex-grow: 1; /* Allow each item to grow to fill available space */
    flex-shrink: 1; /* Allow each item to shrink if needed */
    display: flex; /* Make the list items flex containers */
    justify-content: center; /* Center the content horizontally */
    align-items: center; /* Center the content vertically */
    max-height: 100%; /* Ensure items do not exceed the pill's height */
}

/* Adjust the size of the content (icons, text, etc.) inside the list items */
#color-counters li > *, #category-counters li > * {
    max-height: 100%; /* Adjusted to allow full height */
    max-width: 100%; /* Adjusted to allow full width */
    font-size: 25px; /* Consistent font size with the pill */
}


.hidden {
    display: none !important; // !important to override any other display property
}
#popup-overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 30px;
    background-color: rgba(0, 0, 0, 0.5); /* Overlay background */
    z-index: 1000; /* Ensure it's above other content */
}

#popup-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    max-width: calc(100% - 20px); /* Max width, minus the gap */
    max-height: calc(100% - 20px); /* Max height, minus the gap */
    width: 400px;
    height: 300px;
    background: #fff;
    padding: 20px;
    border-radius: 30px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    z-index: 1001; /* Above the overlay */
    overflow: auto; /* Add scroll for small screens */
}

#popup-content button {
    position: absolute;
    top: 10px;
    right: 10px;
}

#close-popup {
    position: absolute;
    top: 0;
    right: 0;
    padding: 0.5em;
    border: none;
    background-color: transparent;
    font-size: 1em;
    cursor: pointer;
    z-index: 1002;
}

@media screen and (max-width: 420px) {
    #popup-content {
        width: auto; /* Adjust width for very small screens */
    }
}

.dismiss-button {
    border-radius: 30px;
	margin-right: 50px;
    /* Add other styling as needed, e.g., padding, border, background-color, etc. */
}

#popup-text .ql-align-center {
  text-align: center;
}

#popup-text .ql-font-serif {
  font-family: 'Times New Roman', serif;
}

#popup-text .ql-align-right {
  text-align: right;
}

#popup-text .ql-align-justify {
  text-align: justify;
}

#popup-text .ql-align-center {
  text-align: center;
}

.logged-in-info {
    text-align: center; /* Centers the text inside the div */
    padding: 2px 0; /* Adds some padding above and below the text */
    background-color: #f5f1e4; /* Optional: background color, if you want to highlight the div */
    /* Other styling as needed, such as font size, color, etc. */
}


#popup-text img {
  max-width: 95%;  /* Ensures the image does not exceed the width of the popup */
  height: auto;     /* Maintains the aspect ratio of the image */
  display: block;   /* Allows margin auto to work for horizontal centering */
  margin: 0 auto;
  border-radius: 30px; /* Centers the image horizontally */
}

/* Hide all cursors inside the map when marker drawing is active */
.no-cursor .leaflet-container,
.no-cursor .leaflet-container * {
    cursor: none !important;
}

/* Hide the Leaflet draw tooltip */
.leaflet-draw-tooltip {
    display: none !important;
}

.leaflet-control-layers-toggle {
    background-image: url('static/mapicon.png');  /* Check if this path is correct */
    background-color: transparent;
    background-repeat: no-repeat;
    background-position: center;
	border-radius: 50px;
    width: 36px;
    height: 36px;
}


:root {
    /* Define default dark mode colors */
    --counter-pill-bg-color: #111111;
    --counter-pill-text-color: white;
	--background-color: #f5f1e4; /* Dark mode background */
    --text-color: black; /* Dark mode text */
    --sidebar-bg: #d9d4c7; /* Dark mode sidebar background */
  
	--leaflet-control-bg-dark: #111111; /* Dark mode background color */
	--leaflet-control-color-dark: white; /* Dark mode symbol color */
	    --button-close-color-dark: white; /* Color for dark mode */
    --button-close-color-light: black; /* Color for light mode */
	 --outline-hover-color-dark: white; /* Outline color for dark mode */
	     --leaflet-control-layers-before-bg': url("static/mapicon2b.png");

    --outline-hover-color-light: black; /* Outline color for light mode */
  --popup-bg-color-light: rgba(244, 244, 237, 1);
    --popup-text-color-light: black;
    --popup-bg-color-dark: rgba(17, 17, 17, 1);
    --popup-text-color-dark: black;
}

.light-mode {
    /* Define light mode colors */
    --counter-pill-bg-color: #f3f4f8;
    --counter-pill-text-color: black;
	--background-color: #ffffff; /* Light mode background */
    --text-color: black; /* Light mode text */
    --sidebar-bg: #EDF2F4; /* Light mode sidebar background */
    --counter-pill-bg-color: #f3f4f8; /* Light mode counter pill background */
    --counter-pill-text-color: black; /* Light mode counter pill text */
	--leaflet-control-bg-light: #f3f4f8; /* Light mode background color */
	--leaflet-control-color-light: black; /* Light mode symbol color */
}

 .leaflet-draw-draw-polyline, .leaflet-draw-draw-polygon, .leaflet-draw-draw-rectangle, .leaflet-draw-draw-circle, .leaflet-draw-draw-marker, .leaflet-draw-draw-circlemarker, .leaflet-draw-edit-edit, .leaflet-draw-section {
  visibility: hidden; /* Hide the icons */
}
/* Tool selection popup styling */


.container {
    position: relative; /* Ensures that child absolute elements are positioned relative to this */
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 1; /* Ensures the container is above other content */
}



/* Styles for tool buttons inside the popup */
.tool-btn {
    background-color: transparent;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
}

.tool-btn img {
    display: block;
    width: auto;
    height: 30px;
	border-radius: 10px;
    transition: transform 0.2s, outline 0.2s; /* Added transition for outline */
}

.tool-btn:hover img {
    transform: scale(1.02);
    outline: var(--tool-btn-hover-outline);
}

.tool-btn.selected img {
    background-color: rgba(255, 255, 255, 0.3);
    outline: var(--tool-btn-selected-outline);
}

.filter-container {
    display: flex;
    justify-content: center; /* Center items horizontally */
    flex-wrap: wrap; /* Allow items to wrap onto the next line */
    gap: 10px; /* Optional: add some space between elements */
}

/* If elements wrap, they should take the full width of the line */
.filter-container > * {
    flex-basis: 100%;
}
.type-filter {
margin-bottom: 50px;
}

#mobileCategoryOverlay {
    display: none;
    position: fixed; /* Changed from absolute to fixed */
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 100; /* Max value */
    overflow: auto;
    justify-content: center;
    align-items: center;
}

        /* Responsive design */
        @media screen and (min-width: 768px) {
            #mobileCategoryOverlay {
                display: none; /* Hide on non-mobile devices */
            }
        }
		
.categorybutton {
    opacity: 0;
    font-weight: bold;
    line-height: 1;
    cursor: pointer;
    text-decoration: none;
    display: flex;
    max-width: 90%;
    height: auto;
    box-sizing: border-box;
    transition: background-color 0.2s ease-in-out;
    border-radius: 30px;
    text-align: center;
    border: none;
    flex-grow: 1;
    flex-shrink: 1;
    padding: 20px 20px !important;
    margin-left: auto !important;
    margin-right: auto !important;
}


    .categorybutton:hover {
        filter: brightness(115%);
        outline: 3px solid white;
        outline-offset: -3px;
    }

    .categorybutton.selected {
        filter: brightness(115%);
        outline: 5px solid white;
        outline-offset: -5px;
    }
     
        .categorybutton h3 {
            margin: 0; /* Removes any default margin */
            color: white;
        }
		
.button-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
}
#search-filter-section {
    display: none;
	
	      #admin-map {
          display:none !Important;
			
        }
 </style>
<style>

/* Mobile Styles */
@media (max-width: 767px) {
    body, html {
        padding-left: 15px;
        padding-right: 15px;
    }
	
	#tool-selection-popup {
	max-width: 70%;
	margin-top: -2.5px !important;
			margin-bottom: 7.5px;
	}

    #map {
        position: absolute;
        top: calc(9vh + 35px); /* Estimate based on viewport height and gap */
        bottom: 165px; /* Adjust for the fixed height of the sidebar (150px + 15px gap) */
        left: 15px;
        right: 15px;
        border-radius: 30px;
        margin-bottom: 15px;
		margin-top: 7.5px !important;
		z-index: 500!important;
    }

    #sidebar {
        position: fixed;
        height: 150px;
        bottom: 0;
        left: 15px !important;
        right: 15px !important;
        border-radius: 30px;
        margin-bottom: 15px;
        overflow: hidden;
		width: auto;
		    overflow-y: auto; /* Enables vertical scrolling */

		background: var(--sidebar-bg); /* Use variable for background */
    }
	
	

#sidebar-mobileheader {
    position: fixed;
    top: 15px;
    left: 15px;
    right: 15px;
    margin-bottom: 15px !important;
    border-radius: 30px;
    padding-right: 15px;
    padding-left: 15px;
    padding: 7.5px;
    max-height: 81px;
    z-index: 500!important; /* High z-index */
    background: var(--sidebar-bg); /* Use variable for background */
    width: auto; /* Fixed width for testing */
    display: block !important; /* Force display */
}

#sidebar-mobileheader img {
    display: block; /* Use block display for the image */
    max-width: 100%; /* Limit image width to container width */
    max-height: 64px; /* Maximum height for the image */
    height: auto; /* Adjust height automatically */
    width: auto; /* Adjust width automatically */
    margin: auto; /* Center the image if needed */
    object-fit: contain; /* Ensure aspect ratio is maintained without stretching */
}


    .hide-on-mobile {
        display: none !important;
    }

    .appear-on-mobile {
        display: block !important;
    }
}

@media (max-width: 768px) {
    #counter-pill {
        padding: 8px 15px; /* Increased left and right padding */
        font-size: 3vw;
        top: 5.5%;
        max-width: 60%;
    }
	
	.counter-color {
    height: 12px;
    width: 12px;
    border-radius: 50%;
    display: inline-block;
    margin-right: 1.5px; /* Reduced space after the circle */
	    margin-left: 1.5px; /* Reduced space after the circle */

}



    #color-counters, #category-counters {
        display: flex;
        padding: 0;
        margin: 0;
        gap: 5px;
    }

    #color-counters li, #category-counters li {
        flex-grow: 1; /* Allow each item to grow to fill available space */
        flex-shrink: 1; /* Allow each item to shrink if needed */
        display: flex; /* Make the list items flex containers */
        justify-content: center; /* Center the content horizontally */
        align-items: center; /* Center the content vertically */
        max-height: 100%; /* Ensure items do not exceed the pill's height */
    }

    /* Adjust the size of the content (icons, text, etc.) inside the list items */
    #color-counters li > *, #category-counters li > * {
        max-height: 50%; /* Ensure content does not exceed the list item's height */
        max-width: 50%; /* Ensure content does not exceed the list item's width */
        font-size: 2.5vw; /* Responsive font size for the content */
    }
}


/* Media query for tablet devices */
@media (min-width: 768px) and (max-width: 1024px) {
    #map {
        left: 15px; /* Consistent margin from the left */
        right: calc(40% + 0px); /* Adjusting for sidebar width and right margin */
        top: 95px; /* Increased from 15px to 95px to accommodate the top bar's height */
        bottom: 15px; /* Consistent margin from the bottom */
        border-radius: 30px; /* Maintain border radius */
    }

    .counter-color, .marker-btn {
        height: 25px; /* Adjusted to match desktop version */
        width: 25px; /* Adjusted to match desktop version */
        border-radius: 50%;
        display: inline-block;
        margin-right: 5px; /* Consistent space after the circle */
    }

    #sidebar {
        width: calc(40% - 30px); /* Sidebar takes up 40% width minus the total horizontal margins */
        right: 15px; /* Consistent margin from the right */
        top: 95px; /* Increased from 15px to 95px to accommodate the top bar's height */
        bottom: 15px; /* Consistent margin from the bottom */
        padding: 10px; /* Maintain padding */
		    overflow-y: auto; /* Enables vertical scrolling */

        border-radius: 30px; /* Maintain border radius */
        background: var(--sidebar-bg); /* Use variable for background */
    }
}


/* Mobile view */
@media screen and (max-width: 768px) {
    #search-filter-section {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 100;
        overflow: auto;
        justify-content: center;
        align-items: center;
        padding: 20px;
        box-sizing: border-box;
    }

    .filter-container {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    }
}

@media only screen and (max-width: 768px) {
    .key-div {
        display: none !important;
    }
}

@media only screen and (max-width: 767px) {
    .pinlist-div {
        display: none !important;
    }
}

        img {
            border-radius: 30px;
            transition: transform 0.3s ease;
        }

        .logo {
            max-width: 1000px; /* Increase the max-width to make it bigger */
            margin-bottom: 30px;
        }

        img:hover {
        }

   .form-container {
            margin: 40px auto;
            width: 60%;
            background-color: #fff;
            padding: 40px;
            box-shadow: 0px 0px 10px rgba(0,0,0,0.1);
            border-radius: 10px;
            box-sizing: border-box;
        }

        .input-field {
            margin-bottom: 30px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-size: 18px;
            color: #333;
        }

        input[type="text"],
        select,
        #description-editor,
        #benefit-editor {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            font-size: 16px;
            color: #333;
            box-sizing: border-box;
        }

        input[type="file"] {
            border: none;
        }
    .button {
    border-radius: 30px;
    padding: 15px;
    background-color: white;
    font-weight: bold;
    color: black;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s ease; /* Smooth transition for background color */
}

        .register-button {
        background-color: #003056; /* Example color */
        color: white;
        border: none;
        border-radius: 30px;
        padding: 15px 30px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: auto;
        cursor: pointer;
        width: 90%; /* Full width */
        box-sizing: border-box; /* Include padding in width */
    }


.button-container {
    display: flex;
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically if needed */
    width: 100%; /* Take full width of the parent */
    margin-top: 20px; /* Add some space on top */
}


.publish-button {
    width: 100%; /* Full width */
    padding: 20px 0; /* Vertical padding */
    font-size: 20px; /* Font size */
    background-color: #2874A6; /* Background color */
    color: white; /* Text color */
    border-radius: 30px; /* Border radius */
    border: none; /* No border by default */
    cursor: pointer; /* Pointer cursor on hover */
    transition: transform 0.3s ease, border 0.3s ease; /* Smooth transition for transform and border */
}

.publish-button:hover {
    transform: scale(1.02); /* Scale up on hover */
    border: 2px solid black; /* Thin black border on hover */
}


        .project img {
            max-width: 300px; /* Adjust the width as needed */
            max-height: 200px; /* Adjust the height as needed */
            height: auto; /* Maintain aspect ratio */
            width: auto; /* Maintain aspect ratio */
            border-radius: 30px; /* Optional: if you want rounded corners */
        }

.top-bar {
    background-color: #003056; /* Background color of the top bar */
    height: 80px; /* Height of the top bar */
    width: 100%; /* Full width of the screen */
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 20px; /* Add padding to the left and right */
    box-sizing: border-box; /* Include padding in width calculation */
    align-items: center; /* This ensures vertical alignment */
    z-index: 10000; /* Ensures the top bar is above other content */
    position: fixed; /* Fixed positioning to keep the bar at the top */
    top: 0; /* Align to the top */
    left: 0; /* Align to the left */
}

.top-bar a .logo {
    max-width: auto; /* Adjust this value as needed */
    max-height: 80px; /* Ensure the logo fits within the bar's height */
margin: auto;
}

/* Styles for buttons inside links in the top bar */
.top-bar a button {
    transition: transform 0.3s ease; /* Transition for the transform property */
    border-radius: 30px; /* If you want to keep the border-radius */
    /* Add any other button-specific styles here */
}

/* Hover effect for buttons inside links in the top bar */
.top-bar a button:hover {
    transform: scale(1.02); /* Scale up slightly on hover */
}


/* Hover effect for links in the top bar */
.top-bar a:not(:has(button)):hover::after {
    transform: scaleX(1); /* Show the underscore on hover */
    transform-origin: left;
}

.top-bar a {
    color: white;
    text-decoration: none;
    margin-right: 20px; /* Add spacing between links */
    font-size: 18px; /* Increase text size */
    font-weight: bold; /* Make text bold */
    position: relative;
    transition: color 0.3s ease, text-shadow 0.3s ease; /* Transition for color and text shadow */
}


/* Exclude the logo link from having the underline effect */
.top-bar a[href="/"]:hover::after {
    content: none;
}
/* Underline effect for links that do not contain the logo */
.top-bar a:not(:has(> .logo))::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: -3px;
    width: 100%;
    height: 2px;
    background-color: white;
    transform: scaleX(0);
    transform-origin: right;
    transition: transform 0.3s;
}

/* Additional styles for .logo to ensure it fits well in the top bar */
.top-bar a .logo {
    max-width: auto; /* Adjust this value as needed */
    max-height: 80px; /* Ensure the logo fits within the bar's height */
    margin: auto;
}
.top-bar a:hover {
    color: #a8c0ff; /* Change color on hover */
    text-shadow: 0px 0px 8px rgba(255, 255, 255, 0.7); /* Add text shadow on hover */
}

.top-bar a::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: -3px;
    width: 100%;
    height: 2px;
    background-color: white;
    transform: scaleX(0);
    transform-origin: right;
    transition: transform 0.3s;
}

/* Hover effect for buttons inside links in the top bar */
.top-bar a button:hover {
    transform: scale(1.02); /* Scale up slightly on hover */
}

/* Underline effect for links that do not contain buttons */
.top-bar a:not(:has(> button))::after {
    content: "";
    position: absolute;
    left: 0;
    bottom: -3px;
    width: 100%;
    height: 2px;
    background-color: white;
    transform: scaleX(0);
    transform-origin: right;
    transition: transform 0.3s;
}

/* Hover effect to show underline for links that do not contain buttons */
.top-bar a:not(:has(> button)):hover::after {
    transform: scaleX(1);
}
	
.index-image {
    position: relative; /* Change positioning context to relative */
    width: 100%;
    object-fit: cover;
    max-height: 500px;
	border-radius: 0px;
}

.index-image:hover {
 transform: scale(1.00); !important:
}

    .cover-text-container {
        position: absolute;
        top: 70%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.3); /* Black background with 70% opacity */
        padding: 25px;
        border-radius: 80px;
        text-align: center;
    }

    .cover-text-container h1 {
        font-size: 40px;
        color: white;
        margin: 0;
        padding-bottom: 10px;
     text-shadow:
      -2px -2px 0 black,
            2px -2px 0 black,
            -2px 2px 0 black,
            2px 2px 0 black;
    }

    .cover-text-container p {
        font-size: 30px;
        color: white;
        margin: 0;
    text-shadow:
            -2px -2px 0 black,
            2px -2px 0 black,
            -2px 2px 0 black,
            2px 2px 0 black;
    }
	
	    .info-box-container {
            display: flex;
            justify-content: space-evenly;
            padding: 20px;
        }

        .info-box {
            background-color: #1b1b1b;
            border-radius: 30px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease;
            width: 30%; /* Set a fixed width for each box */
        }

        .info-box:hover {
            transform: scale(1.02);
        }
        .info-box-icon {
            max-width: 70px; /* Icon size */
            border-radius: 50%; /* Make it circular */
        }

        .info-box-title {
            color: white;
            font-size: 30px;
            margin: 10px 0;
        }

        .info-box-undertitle {
            color: white;
            font-size: 16px;
        }

        /* Specific colors for each box */
        .box-red {
            background-color: #06467c ;
        }

        .box-blue {
            background-color: #02569d ;
        }

        .box-green {
            background-color: #2874A6 ;
        }
		
	.info-text-field {
            background-color: #F4F4F8; /* Light grey background */
            width: 100%; /* Full width */
            height: 400px; /* Specified height */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            box-sizing: border-box; /* Include padding in width calculation */
        }
        .info-text-container {
            width: 50%; /* Width of the text container */
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .info-text-title {
            font-size: 30px;
            color: black;
            margin-bottom: 10px;
        }

        .info-text-undertitle {
            font-size: 20px;
            color: black;
            margin-top: 10px;
        }

@media only screen and (max-width: 1445px) {
.top-bar a button {
    transition: transform 0.3s ease; /* Transition for the transform property */
    border-radius: 30px; /* If you want to keep the border-radius */
	padding: 7px;
    /* Add any other button-specific styles here */
}

}
#hamburger-button {
    display: none; /* Hidden by default */
	}
@media only screen and (max-width: 1080px) {
    body {
        font-size: 14px; /* Smaller font size */
    }
    .top-bar {
        flex-direction: column; /* Stack items vertically */
        height: auto; /* Adjust height automatically */
    }
    .form-container {
        width: 90%; /* Full width with some margin */
        padding: 20px; /* Smaller padding */
    }
    .publish-button {
        font-size: 18px; /* Slightly smaller font size */
        padding: 15px 0; /* Adjust padding */
    }

	
	/* Hamburger Menu Button */
#hamburger-button {
    display: none; /* Hidden by default */
    font-size: 30px; /* Icon size */
    color: white; /* Icon color */
    background: none; /* No background */
    border: none; /* No border */
    cursor: pointer; /* Pointer cursor */
}

/* Navigation Overlay */
.nav-overlay {
    display: none; /* Hidden by default */
    position: fixed; /* Fixed position */
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.9); /* Semi-transparent black */
    overflow-x: hidden; /* Hide horizontal overflow */
    transition: 0.5s; /* Smooth transition for opening/closing */
    z-index: 1000; /* High z-index to ensure it's on top */
}

.nav-overlay-active .main-content {
    pointer-events: none;
}


/* Mobile Devices */
@media only screen and (max-width: 1080px) {
    #hamburger-button {
        display: block; /* Show the button on mobile */
    }

    .top-bar a .logo {
        margin-left: auto; /* Adjust logo position */
		margin-right: auto;
    }

    #nav-links {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
    }

    #nav-links a {
        padding: 20px; /* Larger clickable area */
        font-size: 24px; /* Larger font size */
    }
}

/* Mobile Devices */
@media only screen and (max-width: 1080px) {
    .top-bar {
        flex-direction: row; /* Align items horizontally */
        justify-content: space-between; /* Space between items */
        align-items: center; /* Vertically center items */
        padding: 10px 15px; /* Consistent padding */
    }

    .top-bar a {
        display: flex; /* Flex container for the logo */
        align-items: center; /* Vertically center logo */
        margin: 0; /* Remove any default margin */
    }

    .top-bar a .logo {
        max-width: 270px; /* Adjust logo size */
        max-height: 350px; /* Adjust height automatically */
    }

    #hamburger-button {
        display: block; /* Show the button on mobile */
        margin: 0; /* Remove any margin */
        align-self: center; /* Explicitly center the button vertically */
    }

   
        #nav-links {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;

    #nav-links a {
        padding: 20px; /* Padding for each link */
        font-size: 24px; /* Font size for links */
    }
}

@media only screen and (max-width: 768px) {
    .info-box-container {
        flex-direction: column;
        align-items: center;
    }

    .info-box {
        width: 80%; /* Adjust width to fit mobile screens */
        margin-bottom: 20px; /* Add some space between the boxes */
    }
}

@media only screen and (max-width: 1080px) {
    .cover-text-container h1 {
        font-size: 4vw; /* Adjust font size for smaller screens */
    }

    .cover-text-container p {
        font-size: 3.5vw; /* Larger size for smaller screens */
    }
	 .cover-text-container {
	        background-color: rgba(0, 0, 0, 0.0) !important; /* Black background with 70% opacity */
			top: 60%;
			        width: 90%; /* Set the width to 90% of the parent container */

}
}





	 .cover-text-container {
	        background-color: rgba(0, 0, 0, 0.4); /* Black background with 70% opacity */
			top: 50%;
			        width: 90%; /* Set the width to 90% of the parent container */

}
}

.info-text-title, .info-text-undertitle {
    font-size: 2.5vw; /* Adjust as needed */
}

@media only screen and (max-width: 1080px) {
    .info-text-title {
        font-size: 4vw; /* Larger size for smaller screens */
    }

    .info-text-undertitle {
        font-size: 3vw; /* Larger size for smaller screens */
    }
}

@media only screen and (max-width: 1080px) {
    .info-text-field {
        height: auto; /* Allow the height to adjust based on content */
    }

    .info-text-container {
        width: 80%; /* Reduce the width for tablets */
    }
}
@media only screen and (max-width: 768px) {
    .info-text-field {
        height: auto; /* Allow the height to adjust based on content */
    }

    .info-text-container {
        width: 90%; /* Reduce the width further for mobile */
    }
}
 </style>
<body>

<!-- Top Bar -->



<div class="top-bar">
    <a href="/">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo" class="logo">
    </a>  
    <button id="hamburger-button">&#9776;</button>

    <div id="nav-overlay" class="nav-overlay">
        <div id="nav-links">
            <a href="/karte">Karte</a>
            <a href="/list">Beiträge</a>
            <a href="/neuerbeitrag">Beitrag hinzufügen</a>
            <a href="/ueber">Über</a>
            <a href="/profil">Profil</a>
 {% if current_user.is_authenticated %}
            <span class="user-info">
                Angemeldet als: {{ current_user.name }}, ID: {{ current_user.id }}
            </span>
            <a href="{{ url_for('logout', next=request.path) }}"><button class="button">Abmelden</button></a>
            {% else %}
            <a href="{{ url_for('login', next=request.path) }}"><button class="button">Anmelden</button></a>
            {% endif %}
        </div>
    </div>
</div>



<!-- Marker Placing Overlay -->
<div id="marker-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0, 0, 0, 0.2); z-index:1000;">
    <div style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:10px;">
        <h2>Add a new marker to the map!</h2>
        <p>First, choose a category in the dropdown below.</p>
        <p>Then, write the text of your marker below in the text field.</p>
        <p>Finally, press the "post a marker" button, for the overlay to disappear. Then, click anywhere on the map. You will then be asked "are you sure you want to place your marker here?" Click "yes", and the marker will be placed where you wanted it!</p>

        <select id="marker-category">
                        <option value="Transport">Transport</option>
            <option value="Öffentliche Plätze">Öffentliche Plätze</option>
            <option value="Environment">Umwelt</option>
            <option value="Verwaltung">Verwaltung</option>
            <option value="Culture">Kultur</option>
            <option value="Education">Bildung</option>
            <option value="Health">Gesundheit</option>
            <option value="Sport">Sport</option>
            <option value="Other">Andere</option>
        </select>
        <br><br>
        <textarea id="marker-description" rows="4" cols="50"></textarea>
        <br><br>
        <button onclick="postMarker()">Post a Marker</button>
    </div>
</div>


<div>
    <div id="mobileCategoryOverlay"></div>

<div id="sidebar-mobileheader" style="display: none;">
<h3 class="appear-on-mobiledisabled resistant-h3" style="display: none; color: white; text-align: center; margin-top: 5px;">
    Wie stehen Sie zu den Orten in Ihrer Gemeinde?
   </h3>
<h3 class="appear-on-mobiledisabled resistant-h3" style="display: none; color: white; text-align: center; margin-top: -12px; margin-bottom: 7px">
    Lassen Sie es uns auf dieser Karte wissen!
   </h3>
</div>
<div id="map">
<!-- Inside the map div -->


</div>
<?php MAP END ?>
<?php SIDEBAR BODY START ?>
<div id="sidebar">


<button id="hideNonMapMarkers">Hide Non-Map Markers</button>


<h3 class="hide-on-mobile resistant-h3" style="display: none; text-align: center; margin-top: 5px;">
    Wie stehen Sie zu den Orten in Ihrer Gemeinde?
</h3>
<h3 class="hide-on-mobile resistant-h3" style="display: none; text-align: center; margin-top: -12px; margin-bottom: 7px">
    Lassen Sie es uns auf dieser Karte wissen!
</h3>

<?php WEBSITE DESCRIPTION END ?>




<!-- SMALL OPTIONS MENU TOP START -->
<div class="smalloptionsmenutop" style="display: flex; align-items: center; justify-content: center;">
<div class="left-container">
<!-- This button shows the user a list of existing pins -->


</div>
<div class="button-s" id="buttonS" onclick="addAndRemoveClass()" style="width: auto; height: auto; padding: 15px; display:none;">
<h3>
      Wie funktioniert's?
     </h3>
</div>

</div>




<?php CITY LOGO START ?>
<img class="hide-on-mobile resistant-image" id="overlay-image" src="static/overlay.jpg" style="max-width: 97%; height: auto; display: block; margin-left:auto; margin-right:auto; margin-top: 3px; margin-bottom: 20px; border-radius: 30px; max-height: 368px;"/>
<?php CITY LOGO END ?>






<h3 style="display: block; text-align: center; margin-top: 5px;">

      Klicken Sie zum ein- und ausblenden.
     </h3>
<div id="category-toggle-buttons">
<div class="button-container">
        <button id="open-overlay" class="register-button" onclick="openMarkerOverlay()">Open Marker placing overlay</button>
    </div>
    <!-- Buttons will be added here dynamically -->
</div>


</div>
<?php CATEGORIES PULL END ?>
</div>
<?php SIDEBAR BODY END ?>

<script type="text/javascript">
// Initialize the map
var map = L.map('map').setView([48.4102, 15.6022], 15);
var currentDrawnLayer = null;
var selectedToolButton = null;
// Track the current base layer
var currentBaseLayer = 'Standardkarte'; // Default layer

// Calculate the offset for boundaries
var horizontalOffset = 1125; // 1.0225 km on each side, total 2.25 km
var verticalOffset = 594; // 0.59375 km on each side, total 1.02875 km

// Define the boundaries
var centerPoint = map.project([48.4102, 15.6022], map.getZoom());
var southWest = map.unproject(centerPoint.subtract([horizontalOffset, verticalOffset]), map.getZoom());
var northEast = map.unproject(centerPoint.add([horizontalOffset, verticalOffset]), map.getZoom());
var bounds = L.latLngBounds(southWest, northEast);


// Calculate extended bounds for 10 km buffer
var extendedHorizontalOffset = horizontalOffset + 1000; // Add 10 km
var extendedVerticalOffset = verticalOffset + 1000; // Add 10 km
var extendedSouthWest = map.unproject(centerPoint.subtract([extendedHorizontalOffset, extendedVerticalOffset]), map.getZoom());
var extendedNorthEast = map.unproject(centerPoint.add([extendedHorizontalOffset, extendedVerticalOffset]), map.getZoom());
var extendedBounds = L.latLngBounds(extendedSouthWest, extendedNorthEast);

// Set the max bounds to restrict dragging beyond 10 km from the original boundary
map.setMaxBounds(extendedBounds);

// Debugging: Log when the user reaches the edge of the draggable area
map.on('drag', function() {
    if (!extendedBounds.contains(map.getCenter())) {
        console.log("Reached the edge of the draggable area");
    }
});

// Define the coordinates for a very large outer rectangle
var outerBounds = [
    L.latLng(-90, -180),
    L.latLng(90, -180),
    L.latLng(90, 180),
    L.latLng(-90, 180),
    L.latLng(-90, -180)
];
        console.log("Boundaries defined:", bounds);


// Define the coordinates for the inner rectangle (the boundary)
var innerBounds = [
    bounds.getSouthWest(),
    bounds.getNorthWest(),
    bounds.getNorthEast(),
    bounds.getSouthEast(),
    bounds.getSouthWest()
];

// Create a polygon with a hole (inverted polygon)
var invertedPolygon = L.polygon([outerBounds, innerBounds], {color: 'grey', fillColor: 'grey', fillOpacity: 0.5}).addTo(map);

// Draw the boundary rectangle
L.rectangle(bounds, {color: "#808080", weight: 2, fill: false}).addTo(map);
        console.log("Boundary rectangle drawn");

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            minZoom: 15,
            attribution: '| © OpenStreetMap contributors'
        }).addTo(map);
		
		// Map layers
var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    minZoom: 15,
    attribution: '....'
});

var satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
    minZoom: 15,
    attribution: '&copy; Esri &mdash; Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, GIS User Community'
});

var thunderforestLayers = {
    "Atlas": L.tileLayer('https://tile.thunderforest.com/atlas/{z}/{x}/{y}.png?apikey=5c57f95ca93348f1a37f6572742a5b48', {
        minZoom: 15,
        attribution: 'Tiles © Thunderforest, ....'
    }),
    "Neighbourhood": L.tileLayer('https://tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey=5c57f95ca93348f1a37f6572742a5b48', {
        minZoom: 15,
        attribution: 'Tiles © Thunderforest, ....'
    }),
    "Transport": L.tileLayer('https://tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=5c57f95ca93348f1a37f6572742a5b48', {
        minZoom: 15,
        attribution: 'Tiles © Thunderforest, ....'
    }),
    "Cycle": L.tileLayer('https://tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=5c57f95ca93348f1a37f6572742a5b48', {
        minZoom: 15,
        attribution: 'Tiles © Thunderforest, ....'
    }),
    "Mobile_Atlas": L.tileLayer('https://tile.thunderforest.com/mobile-atlas/{z}/{x}/{y}.png?apikey=5c57f95ca93348f1a37f6572742a5b48', {
        minZoom: 15,
        attribution: 'Tiles © Thunderforest, ....'
    }),
    "Pioneer": L.tileLayer('https://tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey=5c57f95ca93348f1a37f6572742a5b48', {
        minZoom: 15,
        attribution: 'Tiles © Thunderforest, ....'
    }),
};


// basemap.at layers
var basemapLayers = {
    "GeolandBasemap": L.tileLayer('http://maps.wien.gv.at/basemap/geolandbasemap/normal/google3857/{z}/{y}/{x}.png', {
        minZoom: 15,
        attribution: 'Basemap.at, ....'
    }),
    "BmapGrau": L.tileLayer('http://maps.wien.gv.at/basemap/bmapgrau/normal/google3857/{z}/{y}/{x}.png', {
        minZoom: 15,
        attribution: 'Basemap.at, ....'
    })
};


var baseLayers = {
    "Standardkarte": osmLayer,
    "Satellit": satelliteLayer,
    "Klar": thunderforestLayers.Atlas,
    "Öffi": thunderforestLayers.Transport,
    "Radwege": thunderforestLayers.Cycle,
	"Grau": basemapLayers.BmapGrau,
	"Kontrast": thunderforestLayers.Mobile_Atlas,
    "Papyrus": thunderforestLayers.Pioneer,
};
        // Add default layer to map
        baseLayers["Standardkarte"].addTo(map);


map.on('baselayerchange', function(e) {
    currentBaseLayer = e.name;
    updateMarkerIcons();
});

L.control.layers(baseLayers).addTo(map);


    // Function to create a colored circle icon
// Function to create a colored circle icon
function createIcon(pinSize, outlineSize, fillColor) {
    // Adjustments for pin size and stroke based on base layer
    var adjustedPinSize = currentBaseLayer === 'Satellit' ? pinSize * 2.5 : pinSize * 1.5;
    var strokeColor = currentBaseLayer === 'Satellit' ? 'white' : fillColor;
    var strokeWidth = currentBaseLayer === 'Satellit' ? 5 : outlineSize * 10;
    var strokeOpacity = currentBaseLayer === 'Satellit' ? 1 : 0.5;

    var svgIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="${adjustedPinSize}" height="${adjustedPinSize}" viewBox="0 0 ${adjustedPinSize} ${adjustedPinSize}">
        <circle cx="${adjustedPinSize / 2}" cy="${adjustedPinSize / 2}" r="${adjustedPinSize / 4}" fill="${fillColor}" />
        <circle cx="${adjustedPinSize / 2}" cy="${adjustedPinSize / 2}" r="${adjustedPinSize / 4}" stroke="${strokeColor}" stroke-width="${strokeWidth}" fill="none" stroke-opacity="${strokeOpacity}" />
    </svg>`;

    return L.icon({
        iconUrl: `data:image/svg+xml;base64,${btoa(svgIcon)}`,
        iconSize: [adjustedPinSize, adjustedPinSize],
        iconAnchor: [adjustedPinSize / 2, adjustedPinSize / 2],
        popupAnchor: [0, -adjustedPinSize / 2]
    });
}

function addMarker(latlng, category, description) {
    console.log("Adding marker at:", latlng);

    var fillColor = getCategoryColor(category);
    var markerIcon = createIcon(24, 2, fillColor);

    var marker = L.marker(latlng, { icon: markerIcon });
    marker.bindPopup(`<strong>${category}</strong><br>${description}`).addTo(map);

    console.log("Marker added to the map:", marker);
}

// Function to create a simple SVG icon for cursor
function createCursorIcon(fillColor) {
    var svgCursorIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" fill="${fillColor}" />
    </svg>`;
    return `data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(svgCursorIcon)))}`;
}

// Function to set map cursor
function setMapCursor(category, fillColor) {
    console.log("Attempting to set map cursor...");

    var cursorIconUrl = createCursorIcon(fillColor);
    document.getElementById('map').style.cursor = `url('${cursorIconUrl}') 12 12, auto`;
    
    console.log("ready to place, custom cursor icon activated");
    console.log(`Map cursor set to category icon: ${category}`);
}

// Function to reset map cursor
function resetMapCursor() {
    console.log("Attempting to reset map cursor...");

    document.getElementById('map').style.cursor = '';
    
    console.log("marker has been placed, custom cursor deactivated");
    console.log("Map cursor reset to default");
}


// Function to open marker overlay
    function openMarkerOverlay() {
    document.getElementById('marker-overlay').style.display = 'block';
    console.log("Marker overlay opened");
}
	
   // Function to handle posting a marker
    function postMarker() {
    document.getElementById('marker-overlay').style.display = 'none';
    console.log("Ready to place marker on map");
    console.log("postMarker function called");

    var selectedCategory = document.getElementById('marker-category').value;
    var fillColor = getCategoryColor(selectedCategory);
    setMapCursor(selectedCategory, fillColor);

    map.once('click', function(e) {
        if (confirm("Are you sure you want to place your marker here?")) {
            addMarker(e.latlng, selectedCategory, document.getElementById('marker-description').value);
            console.log("Marker placed at:", e.latlng);
            resetMapCursor();
        } else {
            console.log("Marker placement cancelled");
            resetMapCursor();
        }
    });
}


	

function updateMarkerIcons() {
    for (var category in categoryLayers) {
        categoryLayers[category].eachLayer(function(marker) {
            // Assuming 'outlineSize' value is constant for all markers, adjust if necessary
            var pinSize = 24; // Base pin size
            var outlineSize = 2;
            var fillColor = getCategoryColor(marker.options.category); // Assuming each marker has a 'category' option

            var newIcon = createIcon(pinSize, outlineSize, fillColor);
            marker.setIcon(newIcon);
        });
    }
}



    // Function to get color based on category
    function getCategoryColor(category) {
        switch (category) {
            case 'Transport':
                return '#6f5cff';
            case 'Öffentliche Plätze':
                return '#3d3d3d';
            case 'Environment':
                return '#4CAF50';
            case 'Verwaltung':
                return '#71e5d7';
            case 'Culture':
                return '#494731';
            case 'Education':
                return '#ba82d4';
            case 'Health':
                return '#966577';
            case 'Sport':
                return '#49225a';
            case 'Other':
                return '#4C5454';
            default:
                return '#888'; // Default color
        }
    }

var categoryLayers = {}; // Global object to hold category layers

function addMarkers(projects) {
    projects.forEach(project => {
        if (project.geoloc) {
            var coords = project.geoloc.split(',');
            var latLng = L.latLng(parseFloat(coords[0]), parseFloat(coords[1]));
            var fillColor = getCategoryColor(project.category);

            // Check if descriptionwhy exists and use it, else show an empty string
            var description = project.descriptionwhy ? project.descriptionwhy : "";

            var popupContent = `
                <div style="text-align: center;">
                    ${description}
                </div>
            `;

            var marker = L.marker(latLng, {
                icon: createIcon(24, 2, fillColor),
                category: project.category // Make sure this line is present when creating markers
            }).addTo(map);

            marker.bindPopup(popupContent);

            console.log(`Created a marker for the category: ${project.category}`);

            if (!categoryLayers[project.category]) {
                categoryLayers[project.category] = L.layerGroup().addTo(map);
            }

            marker.addTo(categoryLayers[project.category]);
        }
    });
}



fetch('/get_projects')
    .then(response => response.json())
    .then(data => {
        console.log("Received data:", data);
        addMarkers(data);
        createCategoryButtons();
        updateCategoryButtonColors(); // Call the function here after buttons are created
    })
    .catch(error => console.error('Error fetching projects:', error));

function createCategoryButtons() {
    var container = document.getElementById('category-toggle-buttons');
    for (var category in categoryLayers) {
        var wrapperDiv = document.createElement('div');
        wrapperDiv.style.textAlign = 'center';


 // Create the category button
        var button = document.createElement('button');
        button.innerText = `${category} (${categoryLayers[category].getLayers().length} Beiträge)`;
        button.setAttribute('category-name', category);


        // Apply custom styles to the button
        button.style.fontWeight = 'bold';
        button.style.lineHeight = '1';
        button.style.cursor = 'pointer';
        button.style.textDecoration = 'none';
        button.style.display = 'flex';
        button.style.alignItems = 'center';
        button.style.justifyContent = 'center';
        button.style.width = '97%';
        button.style.height = 'auto';
        button.style.boxSizing = 'border-box';
        button.style.transition = 'background-color 0.2s ease-in-out';
        button.style.borderRadius = '30px';
        button.style.textAlign = 'center';
        button.style.border = '3px solid #3a3a3a'; // Added black border
        button.style.flexGrow = '1';
        button.style.flexShrink = '1';
        button.style.padding = '7px';
        button.style.margin = '7px auto';
        button.style.fontSize = '18px';
        button.style.color = 'white';
        button.style.backgroundColor = getCategoryColor(category);


        applyButtonStyles(button);
        setButtonState(button, category);

  // Add faded effect if the layer is not initially visible
        if (!map.hasLayer(categoryLayers[category])) {
            button.classList.add('faded');
        }

        // Set onclick event
         button.onclick = function() {
            toggleCategory(this.innerText);
            setButtonState(this, this.getAttribute('category-name'));
        };

        wrapperDiv.appendChild(button);
        container.appendChild(wrapperDiv);
    }
}
function setButtonState(button, category) {
    if (map.hasLayer(categoryLayers[category])) {
        button.classList.remove('faded');
    } else {
        button.classList.add('faded');
    }
}


function applyButtonStyles(button) {
    button.style.fontWeight = 'bold';
    // ... rest of the styling ...
}


function toggleCategory(categoryName) {
    for (var category in categoryLayers) {
        if (categoryLayers.hasOwnProperty(category)) {
            var layer = categoryLayers[category];
            var button = document.querySelector(`button[category-name="${category}"]`);
            if (categoryName === `${category} (${layer.getLayers().length} Beiträge)`) {
                if (map.hasLayer(layer)) {
                    map.removeLayer(layer);
                    button.classList.remove('faded');
                } else {
                    map.addLayer(layer);
                    button.classList.add('faded');
                }
            }
        }
    }
}

function updateCategoryButtonColors() {
    const categoryColors = {
        'Transport': '#6f5cff',
        'Öffentliche Plätze': '#3d3d3d',
        'Environment': '#4CAF50',
        'Verwaltung': '#71e5d7',
        'Culture': '#494731',
        'Education': '#ba82d4',
        'Health': '#966577',
        'Sport': '#49225a',
        'Other': '#4C5454'
    };

    const categoryButtons = document.querySelectorAll('#category-toggle-buttons button');

    categoryButtons.forEach(button => {
        const category = button.textContent.trim(); // Assuming the button's text content is the category name
        const color = categoryColors[category];
        if (color) {
            button.style.backgroundColor = color;
        }
    });
}

// Call the function after the buttons are added to the DOM
updateCategoryButtonColors();


// Inside your existing script tag or in a separate JS file

let selectedLatLng;

map.on('click', function(e) {
    selectedLatLng = e.latlng;
    document.getElementById('marker-input-form').style.display = 'block';
});

function addMarker() {
    const category = document.getElementById('marker-category').value;
    const description = document.getElementById('marker-description').value;

    // Close the overlay
    document.getElementById('marker-overlay').style.display = 'none';

    // Create marker at the previously selected location
    const marker = L.marker(selectedLatLng).addTo(map);
    marker.bindPopup(`<strong>${category}</strong><br>${description}`);

    // Send data to server
    saveMarkerData(selectedLatLng, category, description);

    // Clear form inputs
    document.getElementById('marker-category').value = '';
    document.getElementById('marker-description').value = '';

    console.log("Marker added with category:", category, "and description:", description);
}

// Variable to store the selected latitude and longitude

// Event listener for map click
map.on('click', function(e) {
    selectedLatLng = e.latlng;
    document.getElementById('marker-input-form').style.display = 'block';
    console.log("Map clicked at:", selectedLatLng);
});

	// Add this function in your JavaScript

function saveMarkerData(latlng, category, description) {
    // Check if user is authenticated
    // Note: You need to implement the logic to determine if the user is authenticated
    var isAuthenticated = false; // Set this based on the user's authentication status

    // Prepare the data to be sent to the server
    var dataToSend = {
        lat: latlng.lat,
        lng: latlng.lng,
        category: category,
        description: description,
        isAnonymous: !isAuthenticated // Mark as anonymous if the user is not authenticated
    };

    // Send the data using AJAX
    $.ajax({
        url: '/add_marker', // Server endpoint that handles marker data
        method: 'POST',
        data: JSON.stringify(dataToSend),
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        success: function(response) {
            console.log('Marker saved:', response);
            // Optionally, you can handle any post-success actions here
        },
        error: function(error) {
            console.error('Error saving marker:', error);
            // Optionally, handle any error scenarios here
        }
    });
}



</script>
   
   <script>
    // Toggle the navigation overlay when the hamburger button is clicked
    document.getElementById('hamburger-button').addEventListener('click', function() {
        var navOverlay = document.getElementById('nav-overlay');
        navOverlay.classList.toggle('nav-overlay-active');
    });

    // Close the navigation overlay when clicking on the overlay background or on a non-button element
    document.getElementById('nav-overlay').addEventListener('click', function(event) {
        // Close only if the clicked element is not a button or a link
        if (!event.target.closest('button, a')) {
            closeNavOverlay();
        }
    });

    // Function to close the navigation overlay
    function closeNavOverlay() {
        var navOverlay = document.getElementById('nav-overlay');
        navOverlay.classList.remove('nav-overlay-active');
    }

    // Prevent closing when clicking on buttons (delegation)
    document.getElementById('nav-links').addEventListener('click', function(event) {
        if (event.target.tagName === 'BUTTON' || event.target.tagName === 'A') {
            event.stopPropagation();
        }
    });

    // Resize event listener
    window.addEventListener('resize', function() {
        // Check if the window width is greater than the threshold for mobile view
        if (window.innerWidth > 1080) {
            // Make sure the nav-overlay is displayed
            document.getElementById('nav-overlay').classList.add('nav-overlay-active');
        } else {
            // For mobile view, revert back to the default behavior
            document.getElementById('nav-overlay').classList.remove('nav-overlay-active');
        }
    });

    // Call the function on page load to set the initial state

	function toggleOverlay() {
    var overlay = document.getElementById("category-choices");
    if (overlay.style.display === "none") {
        overlay.style.display = "flex";
    } else {
        overlay.style.display = "none";
    }
}

        // JavaScript function to handle redirection to Stimmungskarte
        function redirectToStimmungskarte() {
            window.location.href = '/karte';
        }

        // JavaScript function to handle redirection to Suggest an Idea
        function redirectToList() {
            window.location.href = '/list';
        }

        // JavaScript function to handle redirection to List of Current Suggestions
        function redirectToneuerbeitrag() {
            window.location.href = '/neuerbeitrag';
        }
		
	function toggleMenu() {
    var x = document.getElementById("nav-links");
    if (x.style.display === "block") {
        x.style.display = "none";
    } else {
        x.style.display = "block";
    }
}

    </script>

<script type="text/javascript">
    var userLoggedIn = {{ 'true' if current_user.is_authenticated else 'false' }};
</script>



</body>
</html>
